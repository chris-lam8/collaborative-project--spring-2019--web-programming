window.onload=function(){var e=document.getElementById("thefile"),h=document.getElementById("audio");e.onchange=function(){var e=this.files;h.src=URL.createObjectURL(e[0]),h.load(),h.play();var t=new AudioContext,n=t.createMediaElementSource(h),i=t.createAnalyser(),a=document.getElementById("canvas");a.width=window.innerWidth,a.height=window.innerHeight;var r=a.getContext("2d"),o=new Image;o.src="images/try2.jpg",n.connect(i),i.connect(t.destination),i.fftSize=256;var c=i.frequencyBinCount;console.log(c);var l,d=new Uint8Array(c),g=a.width,f=a.height,u=g/c*2.5,y=0;h.play(),function e(){requestAnimationFrame(e),y=0,i.getByteFrequencyData(d),pattern1=r.createPattern(o,"repeat"),r.fillStyle=pattern1,r.fillRect(0,0,g,f);for(var t=0;t<c;t++){var n=(l=d[t])+t/c*25,a=t/c*250;r.fillStyle="rgb(50,"+a+","+n+")",r.fillRect(y,f-l,u,l),y+=u+1}}()}};